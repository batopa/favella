/**
 * favella v0.4.0 - 2018-09-14
 * https://github.com/batopa/favella
 *
 * Copyright (c) 2018 Alberto Pagliarini
 * Licensed under the MIT license
 */
"speechSynthesis"in window?!function(a){"use strict";var b=a.console.error,c={parentalControl:!1,curses:[],speakOptions:{voice:null,voiceName:null,voiceURI:null,volume:1,rate:1,pitch:0,lang:"en-US",onstart:function(a){},onend:function(a){},onerror:function(a){},onpause:function(a){},onboundary:function(a){},onmark:function(a){}},enabled:!0,muteConsole:!1,recognitionOptions:{lang:"en-US",continuous:!1,interimResults:!1,onaudiostart:function(a){},onsoundstart:function(a){},onspeechstart:function(a){},onspeechend:function(a){},onsoundend:function(a){},onaudioend:function(a){},onresult:function(a,b){},onnomatch:function(a){},onerror:function(a){},onstart:function(a){},onend:function(a){}}},d=[],e=null;!("SpeechRecognition"in a)&&"webkitSpeechRecognition"in a&&(a.SpeechRecognition=a.webkitSpeechRecognition);var f=function(a,b){var c={};return Object.keys(b).forEach(function(d){"undefined"==typeof a[d]?c[d]=b[d]:"undefined"!=typeof b[d]&&(c[d]=a[d])}),c},g={getConfig:function(a){var b=a&&"undefined"!=typeof c[a]?c[a]:c;return b},setup:function(a){return a&&"object"==typeof a&&Object.keys(a).forEach(function(b){var d=a[b];"speakOptions"!=b&&"recognitionOptions"!=b||"object"!=typeof d?"curses"==b&&Array.isArray(d)?c.curses=d:"parentalControl"==b?c.parentalControl=!!d:"mute"==b&&(d===!0||"console"==d)&&(c.mute=d):c[b]=f(a[b],c[b])}),this},mute:function(a){a&&"console"==a?(c.muteConsole=!0,console.log("console.error muted")):(c.enabled=!1,console.log("Ho perso la favella (I lost the power of speech)!"))},unmute:function(){c.enabled?c.muteConsole&&console.log("console.error unmuted"):console.log("Ho riacquistato la favella (I recover the power of speech)!"),c.enabled=!0,c.muteConsole=!1},isMute:function(a){return a&&"console"==a?c.muteConsole:!c.enabled},isListening:function(){return!!e},getVoice:function(a){var b=this.getVoices();if(b.length){for(var c=0;c<b.length;c++)if(b[c].name===a||b[c].lang===a)return b[c];return console.log("Sorry, "+foundVoice+" is not supported. Fallback to en-US."),this.getVoice("en-US")}},listen:function(b){if(a.SpeechRecognition&&!this.isListening()){var d="";e=new SpeechRecognition,b=b||{},b=f(b,c.recognitionOptions),Object.keys(b).forEach(function(a){"onresult"==a?e.onresult=function(a){for(var c="",e="",f=d,g=a.resultIndex;g<a.results.length;++g)a.results[g].isFinal?d+=a.results[g][0].transcript:c+=a.results[g][0].transcript;e=d.replace(f,""),b.onresult(a,{isFinal:!c,interim:c,"final":d,partial:e})}:"onend"==a?e.onend=function(a){b.onend(a),e=null}:"onerror"==a?e.onerror=function(a){console.error(a.type+": "+a.error)}:e[a]=b[a]}),e.start()}return this},stopListen:function(a){this.isListening()&&(a?e.abort():e.stop())},speak:function(b,d){if(!c.enabled)return!1;b&&"string"==typeof b||(b="Something goes wrong"),d=d||{},d=f(d,c.speakOptions);var e=new SpeechSynthesisUtterance;return e.voice=this.getVoice(d.voiceName||d.lang),console.log("Voice selected: "+e.voice.name),e.voiceURI=e.voice.voiceURI,e.volume=d.volume,e.rate=d.rate,e.pitch=d.pitch,e.lang=e.voice.lang,e.text=b,["onstart","onend","onerror","onboundary","onmark"].forEach(function(a){d[a]&&"function"==typeof d[a]&&(e[a]=d[a])}),a.speechSynthesis.speak(e),this},parrotMode:function(a){if(this.isListening())this.stopListen(),this.speak("Parrode mode off");else{var b=this.getVoice(a);if(b.lang!=a)return void console.error("Language not supported. Parrot mode fail");var c=this;this.speak("Parrot mode on",{onend:function(){var a={lang:b.lang,interimResults:!1,continuous:!0,onresult:function(a,d){d.isFinal&&d.partial&&(console.log(d.partial),c.speak(d.partial,{lang:b.lang,volume:1,rate:1,pitch:.1}))}};c.listen(a)}})}},getVoices:function(b){return(!d.length||b)&&(d=a.speechSynthesis.getVoices()),d},pause:function(){a.speechSynthesis.pause()},resume:function(){a.speechSynthesis.resume()},cancel:function(){a.speechSynthesis.cancel()},isSpeaking:function(){return a.speechSynthesis.speaking},isPending:function(){return a.speechSynthesis.pending},isPaused:function(){return a.speechSynthesis.paused},me:function(a){var b="it-IT",c=this.getConfig("speakOptions").voiceName;a&&(b="en-US",c="");var d=this.getVoice(b);if(d){var e=[];"it-IT"==d.lang?e.push("favella"):e=["Sorry, I cannot pronunce it properly because italian voice is missing. I will try anyway.","favella.","Shit!"];var f=this;e.forEach(function(a){f.speak(a,{volume:1,rate:1,pitch:0,voiceName:c,lang:d.lang})})}else console.log("Missing voice :(")}};a.speechSynthesis.speaking&&a.speechSynthesis.cancel(),a.speechSynthesis.onvoiceschanged=function(){g.getVoices(!0)},a.console.error=function(){if(!g.isMute("console")){var c=Array.prototype.slice.call(arguments),d=c[0],e=g.getConfig();!e.parentalControl&&e.curses.length&&(d+=". "+e.curses[Math.floor(Math.random()*e.curses.length)]+"!"),g.speak(d)}b.apply(a.console,arguments)},"undefined"!=typeof module&&module.exports?module.exports=g:a.Favella=g}(window):console.log("Sorry, speechSynthesis is not supported on this browser");
//# sourceMappingURL=favella.min.js.map